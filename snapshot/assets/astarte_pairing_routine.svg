<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="771px" height="682px" version="1.1" style="background-color: rgb(255, 255, 255);"><defs/><g transform="translate(0.5,0.5)"><g transform="translate(235.5,7.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="38" height="14" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 14px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 40px; white-space: nowrap; word-wrap: normal; font-weight: bold; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">Client</div></div></foreignObject><text x="19" y="14" fill="#000000" text-anchor="middle" font-size="14px" font-family="Helvetica" font-weight="bold">Client</text></switch></g><g transform="translate(14.5,-0.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="140" height="30" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 14px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 142px; white-space: nowrap; word-wrap: normal; font-weight: bold; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">Agent<div>(Client if Fake Agent)</div></div></div></foreignObject><text x="70" y="22" fill="#000000" text-anchor="middle" font-size="14px" font-family="Helvetica" font-weight="bold">Agent&lt;div&gt;(Client if Fake Agent)&lt;/div&gt;</text></switch></g><g transform="translate(387.5,7.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="64" height="14" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 14px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 66px; white-space: nowrap; word-wrap: normal; font-weight: bold; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">Transport</div></div></foreignObject><text x="32" y="14" fill="#000000" text-anchor="middle" font-size="14px" font-family="Helvetica" font-weight="bold">Transport</text></switch></g><g transform="translate(560.5,7.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="48" height="14" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 14px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 48px; white-space: nowrap; word-wrap: normal; font-weight: bold; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">Pairing</div></div></foreignObject><text x="24" y="14" fill="#000000" text-anchor="middle" font-size="14px" font-family="Helvetica" font-weight="bold">Pairing</text></switch></g><g transform="translate(724.5,7.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="20" height="14" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 14px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 22px; white-space: nowrap; word-wrap: normal; font-weight: bold; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">CA</div></div></foreignObject><text x="10" y="14" fill="#000000" text-anchor="middle" font-size="14px" font-family="Helvetica" font-weight="bold">CA</text></switch></g><path d="M 85 680 L 85 50" fill="none" stroke="#000000" stroke-miterlimit="10" stroke-dasharray="1 4" pointer-events="none"/><path d="M 255 680 L 255 50" fill="none" stroke="#000000" stroke-miterlimit="10" stroke-dasharray="1 4" pointer-events="none"/><path d="M 420 680 L 420 50" fill="none" stroke="#000000" stroke-miterlimit="10" stroke-dasharray="1 4" pointer-events="none"/><path d="M 585 680 L 585 50" fill="none" stroke="#000000" stroke-miterlimit="10" stroke-dasharray="1 4" pointer-events="none"/><path d="M 735 680 L 735 50" fill="none" stroke="#000000" stroke-miterlimit="10" stroke-dasharray="1 4" pointer-events="none"/><path d="M 85 80 L 243.63 80" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 248.88 80 L 241.88 83.5 L 243.63 80 L 241.88 76.5 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><g transform="translate(95.5,46.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="148" height="26" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 148px; white-space: normal; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">Agent gets Device ID and other infos</div></div></foreignObject><text x="74" y="19" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">Agent gets Device ID and other infos</text></switch></g><path d="M 255 90 L 96.37 90" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 91.12 90 L 98.12 86.5 L 96.37 90 L 98.12 93.5 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 85 130 L 573.63 130" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 578.88 130 L 571.88 133.5 L 573.63 130 L 571.88 126.5 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><g transform="translate(241.5,113.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="216" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 216px; white-space: nowrap; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">Agent requests an API Key for the Client</div></div></foreignObject><text x="108" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">Agent requests an API Key for the Client</text></switch></g><path d="M 585 140 L 96.37 140" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 91.12 140 L 98.12 136.5 L 96.37 140 L 98.12 143.5 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 85 190 L 243.63 190" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 248.88 190 L 241.88 193.5 L 243.63 190 L 241.88 186.5 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><g transform="translate(95.5,156.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="148" height="26" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 148px; white-space: normal; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">Agent delivers API Key to Device</div></div></foreignObject><text x="74" y="19" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">Agent delivers API Key to Device</text></switch></g><g transform="translate(94.5,200.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="150" height="18" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 17px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 152px; white-space: nowrap; word-wrap: normal; font-weight: bold; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">Agent Scope Ends</div></div></foreignObject><text x="75" y="18" fill="#000000" text-anchor="middle" font-size="17px" font-family="Helvetica" font-weight="bold">Agent Scope Ends</text></switch></g><path d="M 255 310 L 573.63 310" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 578.88 310 L 571.88 313.5 L 573.63 310 L 571.88 306.5 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><g transform="translate(280.5,279.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="278" height="26" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 278px; white-space: normal; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">Client submits a Pairing request containing a CSR and its API Key</div></div></foreignObject><text x="139" y="19" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">Client submits a Pairing request containing a CSR and its API Key</text></switch></g><path d="M 585 335 L 723.63 335" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 728.88 335 L 721.88 338.5 L 723.63 335 L 721.88 331.5 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><g transform="translate(595.5,287.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="128" height="40" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 128px; white-space: normal; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">Pairing authenticates the request and asks the CA to sign the CSR</div></div></foreignObject><text x="64" y="26" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><path d="M 735 345 L 596.37 345" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 591.12 345 L 598.12 341.5 L 596.37 345 L 598.12 348.5 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 585 385 L 266.37 385" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 261.12 385 L 268.12 381.5 L 266.37 385 L 268.12 388.5 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><g transform="translate(317.5,368.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="214" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 216px; white-space: nowrap; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">Pairing replies with the signed certificate</div></div></foreignObject><text x="107" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">Pairing replies with the signed certificate</text></switch></g><path d="M 255 460 L 413.63 460" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 418.88 460 L 411.88 463.5 L 413.63 460 L 411.88 456.5 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><g transform="translate(265.5,412.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="148" height="40" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 148px; white-space: normal; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">Client uses its Certificate to authenticate against the Transport</div></div></foreignObject><text x="74" y="26" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><path d="M 420 485 L 723.63 485" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 728.88 485 L 721.88 488.5 L 723.63 485 L 721.88 481.5 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><g transform="translate(450.5,449.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="268" height="26" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 268px; white-space: normal; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">Transports verifies the certificate against the CA and checks for revocation information</div></div></foreignObject><text x="134" y="19" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">Transports verifies the certificate against the CA and checks for revocation information</text></switch></g><path d="M 735 495 L 431.37 495" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 426.12 495 L 433.12 491.5 L 431.37 495 L 433.12 498.5 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 421 552 L 262.37 552" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 257.12 552 L 264.12 548.5 L 262.37 552 L 264.12 555.5 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><g transform="translate(266.5,511.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="148" height="26" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 148px; white-space: normal; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">Transport authenticates and registers the Client</div></div></foreignObject><text x="74" y="19" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">Transport authenticates and registers the Client</text></switch></g><path d="M 255 665 Q 160 475 246.72 330.46" fill="none" stroke="#000000" stroke-miterlimit="10" stroke-dasharray="1 1" pointer-events="none"/><path d="M 249.42 325.96 L 248.82 333.76 L 246.72 330.46 L 242.82 330.16 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><g transform="translate(265.5,651.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="148" height="26" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 148px; white-space: normal; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">Certificate becomes invalid for any reason</div></div></foreignObject><text x="74" y="19" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">Certificate becomes invalid for any reason</text></switch></g><g transform="translate(265.5,591.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="148" height="26" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 148px; white-space: normal; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">Client disconnects and should reconnect</div></div></foreignObject><text x="74" y="19" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">Client disconnects and should reconnect</text></switch></g><path d="M 255 605 Q 210 525 195 457.5 Q 180 390 247.15 255.7" fill="none" stroke="#000000" stroke-miterlimit="10" stroke-dasharray="1 1" pointer-events="none"/><path d="M 249.5 251 L 249.5 258.83 L 247.15 255.7 L 243.24 255.7 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 255 250 L 573.63 250" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 578.88 250 L 571.88 253.5 L 573.63 250 L 571.88 246.5 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><g transform="translate(260.5,220.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="318" height="26" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 318px; white-space: normal; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">Client handshakes with Pairing to get information on the transport and verify whether its certificate is valid</div></div></foreignObject><text x="159" y="19" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">Client handshakes with Pairing to get information on the transport and verify whether its certificate is valid</text></switch></g><path d="M 585 261 L 266.37 261" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 261.12 261 L 268.12 257.5 L 266.37 261 L 268.12 264.5 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 256 260 Q 120 360 244.95 456.12" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 249.11 459.32 L 241.43 457.82 L 244.95 456.12 L 245.7 452.28 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><g transform="translate(134.5,353.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="35" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 37px; white-space: nowrap; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">If Valid</div></div></foreignObject><text x="18" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">If Valid</text></switch></g><path d="M 256 260 Q 100 280 243.76 308.75" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 248.9 309.78 L 241.35 311.84 L 243.76 308.75 L 242.73 304.98 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><g transform="translate(107.5,273.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="45" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 45px; white-space: nowrap; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">If Invalid</div></div></foreignObject><text x="23" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">If Invalid</text></switch></g><path d="M 82 230 L 257 230" fill="none" stroke="#000000" stroke-width="3" stroke-miterlimit="10" pointer-events="none"/></g></svg>