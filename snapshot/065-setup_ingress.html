<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="generator" content="ExDoc v0.21.3">
    <meta name="project" content="Astarte v1.0.0-dev">
    <title>Setting up the Ingress â€” Astarte v1.0.0-dev</title>
    <link rel="stylesheet" href="dist/elixir-0ab8a6a80ebaaa287431.css" />
    <script src="dist/sidebar_items-2629822f45.js"></script>
      <script src="docs_config.js"></script>
    <script async src="dist/app-a225d03098e64fef431a.js"></script>
  </head>
  <body data-type="extras">
    <script>try { if(localStorage.getItem('night-mode') === 'true') document.body.className += ' night-mode'; } catch (e) { }</script>
<div class="main">

<button class="sidebar-button sidebar-toggle">
  <span class="icon-menu" title="Collapse/expand sidebar"></span>
</button>

<section class="sidebar">
  <form class="sidebar-search" action="search.html">
    <button type="submit" class="search-button">
      <span class="icon-search" aria-hidden="true"></span>
    </button>
    <button type="button" tabindex="-1" class="search-close-button">
      <span class="icon-cross" title="Cancel search"></span>
    </button>
    <label class="search-label">
      <input name="q" type="text" id="search-list" class="search-input" placeholder="Search..." aria-label="Search" autocomplete="off" />
    </label>
  </form>

  <div class="autocomplete">
    <div class="autocomplete-results">
    </div>
  </div>

  <div class="sidebar-header">
    <div class="sidebar-projectDetails">
      <a href="http://astarte-platform.org" class="sidebar-projectName">
Astarte      </a>
      <h2 class="sidebar-projectVersion">
        v1.0.0-dev
      </h2>
    </div>
      <a href="http://astarte-platform.org">
        <img src="assets/logo.png" alt="Astarte" class="sidebar-projectImage">
      </a>
  </div>

  <ul class="sidebar-listNav">
    <li><a id="extras-list" href="#full-list">Pages</a></li>


  </ul>
  <div class="gradient"></div>
  <ul id="full-list" class="sidebar-fullList"></ul>
</section>

<section class="content">
  <div class="content-outer">
    <div id="content" class="content-inner">


<h1>Setting up the Ingress</h1>
<p>Once your Cluster <a href="060-setup_cluster.html">is up and running</a>, to expose it to the outer world you
need to set up an Ingress. Currently, the only managed and supported Ingress is based upon
<a href="https://github.com/appscode/voyager">Voyager</a>, and this guide will cover only this specific case.</p>
<p>Of course, ensure you have installed <a href="https://appscode.com/products/voyager/latest/setup/install/">Voyager Operator</a>
before you begin.</p>
<h2 id="creating-an-astartevoyageringress" class="section-heading">
  <a href="#creating-an-astartevoyageringress" class="hover-link"><span class="icon-link" aria-hidden="true"></span></a>
  Creating an AstarteVoyagerIngress
</h2>

<p>Most information needed for exposing your Ingress have already been given in your main Astarte
resource. If your Kubernetes installation supports LoadBalancer ingresses (most managed ones do),
you should be able to get away with the most standard CR:</p>
<pre><code class="yaml">apiVersion: api.astarte-platform.org/v1alpha1
kind: AstarteVoyagerIngress
metadata:
  name: example-minimal
  namespace: astarte
spec:
  # The Astarte Instance the Ingress will be attached to
  astarte: example-minimal
  api:
    exposeHousekeeping: true
  dashboard:
    ssl: true
    host: &quot;dashboard.astarte.yourdomain.com&quot; # When not specified, dashboard will be deployed in /dashboard in the API host.
  letsencrypt:
    use: true
    acmeEmail: info@yourdomain.com
    challengeProvider:
      dns:
        provider: digitalocean
        credentialSecretName: voyager-digitalocean</code></pre>
<p>As you might see, there&#39;s only one very important thing to be noted: the <code class="inline">astarte</code> field must reference the name of an
existing Astarte installation in the same namespace, and the Ingress will be configured and attached to that instance.</p>
<h2 id="ssl-and-certificates" class="section-heading">
  <a href="#ssl-and-certificates" class="hover-link"><span class="icon-link" aria-hidden="true"></span></a>
  SSL and Certificates
</h2>

<p>Astarte heavily requires SSL in a number of interactions, even though this can be bypassed with <code class="inline">ssl: false</code>. If you
do not have any SSL Certificates for your domains, you can leverage Voyager&#39;s Let&#39;s Encrypt integration.
AstarteVoyagerIngress integrates directly with Voyager&#39;s native types, and you can follow along
<a href="https://github.com/appscode/voyager/tree/master/docs/guides/certificate">Voyager&#39;s Let&#39;s Encrypt guide</a>.
Simply set <code class="inline">letsencrypt.use</code> to <code class="inline">true</code>, and fill the <code class="inline">challengeProvider</code> with the right parameters.</p>
<h2 id="api-paths" class="section-heading">
  <a href="#api-paths" class="hover-link"><span class="icon-link" aria-hidden="true"></span></a>
  API Paths
</h2>

<p><code class="inline">AstarteVoyagerIngress</code> deploys a well-known tree of APIs to the <code class="inline">host</code> you specified in the main <code class="inline">Astarte</code> resource.
In particular, assuming your API host was <code class="inline">api.astarte.yourdomain.com</code>:</p>
<ul>
<li>Housekeeping API base URL will be <a href="https://api.astarte.yourdomain.com/housekeeping/v1">https://api.astarte.yourdomain.com/housekeeping/v1</a>
</li>
<li>Realm Management API base URL will be <a href="https://api.astarte.yourdomain.com/realmmanagement/v1">https://api.astarte.yourdomain.com/realmmanagement/v1</a>
</li>
<li>Pairing API base URL will be <a href="https://api.astarte.yourdomain.com/pairing/v1">https://api.astarte.yourdomain.com/pairing/v1</a>
</li>
<li>AppEngine API base URL will be <a href="https://api.astarte.yourdomain.com/appengine/v1">https://api.astarte.yourdomain.com/appengine/v1</a>
</li>
</ul>
<h2 id="further-customization" class="section-heading">
  <a href="#further-customization" class="hover-link"><span class="icon-link" aria-hidden="true"></span></a>
  Further customization
</h2>

<p><code class="inline">AstarteVoyagerIngress</code> has a number of advanced options that can be used to accommodate needs of the most diverse
deployments. Consult the
<a href="https://github.com/astarte-platform/astarte-kubernetes-operator/blob/master/deploy/crds/api.astarte-platform.org_astartevoyageringresses_crd.yaml">CRD Documentation</a>
to learn more.</p>
      <footer class="footer">
        <p>
          <span class="line">
            Built using
            <a href="https://github.com/elixir-lang/ex_doc" title="ExDoc" target="_blank" rel="help noopener">ExDoc</a> (v0.21.3),
          </span>
          <span class="line">
            designed by
            <a href="https://twitter.com/dignifiedquire" target="_blank" rel="noopener" title="@dignifiedquire">Friedel Ziegelmayer</a>.
          </span>
        </p>
        <p>
          <button class="line footer-button display-shortcuts-help">
            Display keyboard shortcuts
          </button>
          <button class="line footer-button night-mode-toggle">
            Toggle night mode
          </button>
          <button class="line footer-button display-quick-switch">
            Go to a HexDocs package
          </button>
          <button class="line footer-button tooltips-toggle">
            <span class="tooltips-option-disable">Disable tooltips</span>
            <span class="tooltips-option-enable">Enable tooltips</span>
          </button>
        </p>
      </footer>
    </div>
  </div>
</section>
</div>
  </body>
</html>

